From 4ca3014b009fc7702a65b23f027fc9c8e4fe9752 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Fri, 20 Oct 2017 21:54:02 -0400
Subject: [PATCH] Provide E/TE/Chunk count stat methods

Provides counts without the ineffeciency of using .getEntities().size()
which creates copy of the collections.

diff --git a/src/main/java/org/bukkit/craftbukkit/CraftWorld.java b/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
index 8e70399..bfb38de 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
@@ -119,6 +119,30 @@ public class CraftWorld implements World {
     private int ambientSpawn = -1;
     private int chunkLoadCount = 0;
     private int chunkGCTickCount;
+
+    // Paper start - Provide fast information methods
+    public int getEntityCount() {
+        return world.loadedEntityList.size();
+    }
+    public int getTileEntityCount() {
+        // We don't use the full world tile entity list, so we must iterate chunks
+        int size = 0;
+        for (net.minecraft.world.chunk.Chunk chunk : ((ChunkProviderServer) world.getChunkProvider()).id2ChunkMap.values()) {
+            size += chunk.tileEntities.size();
+        }
+        return size;
+    }
+    public int getTickableTileEntityCount() {
+        return world.tickableTileEntities.size();
+    }
+    public int getChunkCount() {
+        return world.getChunkProvider().id2ChunkMap.size();
+    }
+    public int getPlayerCount() {
+        return world.playerEntities.size();
+    }
+    // Paper end
+
     private static final Random rand = new Random();
     private final Spigot spigot =
             new Spigot() {
-- 
2.18.0

