From 212387f87fc6d2823876699c3dd39e2a8698d4ea Mon Sep 17 00:00:00 2001
From: Jadon Fowler <jadonflower@gmail.com>
Date: Tue, 10 Oct 2017 15:13:52 -0400
Subject: [PATCH] Toggleable Elytra Wall Damage

Instead of calculating the damage taken from hitting a wall, you can
disable it in the config.

diff --git a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
index d345d4e..98abb04 100644
--- a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
+++ b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
@@ -349,4 +349,9 @@ public class PaperWorldConfig {
             delayChunkUnloadsBy *= 1000;
         }
     }
+
+    public boolean elytraHitWallDamage = true;
+    private void elytraHitWallDamage() {
+        elytraHitWallDamage = getBoolean("elytra-hit-wall-damage", true);
+    }
 }
diff --git a/src/main/java/net/minecraft/entity/EntityLivingBase.java b/src/main/java/net/minecraft/entity/EntityLivingBase.java
index ef7b46d..3cca03e 100644
--- a/src/main/java/net/minecraft/entity/EntityLivingBase.java
+++ b/src/main/java/net/minecraft/entity/EntityLivingBase.java
@@ -1723,6 +1723,7 @@ public abstract class EntityLivingBase extends Entity {
             if (!this.isInWater() || this instanceof EntityPlayer && ((EntityPlayer) this).capabilities.isFlying) {
                 if (!this.isInLava() || this instanceof EntityPlayer && ((EntityPlayer) this).capabilities.isFlying) {
                     if (this.isElytraFlying()) {
+                        if (world.paperConfig.elytraHitWallDamage) { // Paper start - Toggleable Elytra Wall Damage
                         if (this.motionY > -0.5D) {
                             this.fallDistance = 1.0F;
                         }
@@ -1770,6 +1771,7 @@ public abstract class EntityLivingBase extends Entity {
                                 this.attackEntityFrom(DamageSource.FLY_INTO_WALL, f8);
                             }
                         }
+                        } // Paper end - Elyta Wall Damage if statement
 
                         if (this.onGround
                                 && !this.world.isRemote
-- 
2.18.0

