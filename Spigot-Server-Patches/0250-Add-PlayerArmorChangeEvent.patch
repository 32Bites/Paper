From 731e4e738d32836b59ebe3caa97b4fdb269531e6 Mon Sep 17 00:00:00 2001
From: pkt77 <parkerkt77@gmail.com>
Date: Fri, 10 Nov 2017 23:46:34 -0500
Subject: [PATCH] Add PlayerArmorChangeEvent


diff --git a/src/main/java/net/minecraft/entity/EntityLivingBase.java b/src/main/java/net/minecraft/entity/EntityLivingBase.java
index c5098df..0308dc1 100644
--- a/src/main/java/net/minecraft/entity/EntityLivingBase.java
+++ b/src/main/java/net/minecraft/entity/EntityLivingBase.java
@@ -1,5 +1,6 @@
 package net.minecraft.entity;
 
+import com.destroystokyo.paper.event.player.PlayerArmorChangeEvent;
 import com.google.common.base.Function;
 import com.google.common.base.Objects;
 import com.google.common.collect.Lists;
@@ -1992,6 +1993,13 @@ public abstract class EntityLivingBase extends Entity {
                 ItemStack itemstack1 = this.getItemStackFromSlot(enumitemslot);
 
                 if (!ItemStack.areItemStacksEqual(itemstack1, itemstack)) {
+                    // Paper start - PlayerArmorChangeEvent
+                    if (this instanceof EntityPlayer && enumitemslot.getSlotType() == EntityEquipmentSlot.Type.ARMOR && !itemstack.getItem().equals(itemstack1.getItem())) {
+                        final org.bukkit.inventory.ItemStack oldItem = CraftItemStack.asBukkitCopy(itemstack);
+                        final org.bukkit.inventory.ItemStack newItem = CraftItemStack.asBukkitCopy(itemstack1);
+                        new PlayerArmorChangeEvent((Player) this.getBukkitEntity(), PlayerArmorChangeEvent.SlotType.valueOf(enumitemslot.name()), oldItem, newItem).callEvent();
+                    }
+                    // Paper end
                     ((WorldServer) this.world)
                             .getEntityTracker()
                             .sendToTracking(this, new SPacketEntityEquipment(this.getEntityId(), enumitemslot, itemstack1));
-- 
2.18.0

